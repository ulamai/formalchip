[project]
name = "pilot-control"
rtl_files = ["rtl/top.sv"]
top_module = "top"
clock = "clk"
reset = "rst_n"
reset_active_low = true
signal_aliases = { request = "req", acknowledge = "ack" }

[llm]
backend = "deterministic"
model = "formalchip-template-v1"

[engine]
kind = "mock"
pass_after = 2

[loop]
max_iterations = 3
workdir = ".formalchip/runs"

[[specs]]
kind = "text"
path = "spec/control_logic.md"

[[specs]]
kind = "register_csv"
path = "spec/registers.csv"
signal_template = "{name_lower}_q"
sw_we_signal = "sw_we"
sw_addr_signal = "sw_addr"
sw_addr_width = 32

[[specs]]
kind = "rule_table_csv"
path = "spec/protocol_rules.csv"

[[libraries]]
kind = "handshake"
req = "req"
ack = "ack"
bound = 4

[[libraries]]
kind = "fifo_safety"
full = "fifo_full"
empty = "fifo_empty"
push = "fifo_push"
pop = "fifo_pop"

[[libraries]]
kind = "reset_sequence"
signal = "valid"
value = "1'b0"
latency = 1

[[libraries]]
kind = "inline"
name = "ctrl_write_decode_valid"
expr = "(sw_we && (sw_addr == 32'h00000004)) |-> !fifo_full"
property_kind = "assert"

[constraints]
assumptions = [
  { name = "env_no_fifo_push_pop_when_empty", expr = "!(fifo_push && fifo_pop && fifo_empty)", note = "Avoid unrealistic simultaneous empty pop" }
]
covers = [
  { name = "cover_req_ack", expr = "req ##[1:4] ack", note = "Observe at least one request/ack sequence" }
]

[kpi]
min_time_reduction_percent = 30.0
require_bug_or_coverage = true
